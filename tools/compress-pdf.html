<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compress PDF Online Free: Reduce PDF File Size</title>
    <meta name="description" content="Compress PDF Files Online for Free. Reduce File Size While Maintaining Quality. No Upload to Server, 100% Secure Browser-Based Compression.">
    <meta name="keywords" content="compress pdf online free, reduce pdf size, pdf compressor, compress pdf file">
    <link rel="canonical" href="https://tools.rojgarsangam.in/tools/compress-pdf">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"/>
    <link rel="preconnect" href="https://tools.rojgarsangam.in" crossorigin>
    <link rel="dns-prefetch" href="https://tools.rojgarsangam.in">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- WebApplication Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Compress PDF Online Free",
      "url": "https://tools.rojgarsangam.in/tools/compress-pdf",
      "description": "Compress PDF Files Online for Free. Reduce File Size While Maintaining Quality. No Upload to Server, 100% Secure Browser-Based Compression.",
      "applicationCategory": "UtilitiesApplication",
      "operatingSystem": "Any",
      "browserRequirements": "Requires JavaScript",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Compress PDF without quality loss",
        "Browser-based PDF compression",
        "No file upload to server",
        "Multiple compression levels",
        "Batch PDF compression"
      ]
    }
    </script>

    <!-- FAQPage Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "How Much can I Compress a PDF File?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Compression Depends on The Original File Content. Typically, You can Reduce File Size by 40-60% While Maintaining Good Visual Quality."
          }
        },
        {
          "@type": "Question",
          "name": "Which Compression Level Should I Choose?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "We Recommend the Recommended Compression Option for the Best Balance Between File Size and Quality. Use Extreme for Maximum Reduction when File Size is the priority."
          }
        },
        {
          "@type": "Question",
          "name": "Is My PDF Safe During Compression?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, All Compression is Done Locally in Your Browser. Your Files Never Leave Your Device and are Not Stored on Any Server. It is 100% private and secure."
          }
        },
        {
          "@type": "Question",
          "name": "What is the Maximum File Size I can Compress?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can compress PDF files of any size. However, very large files may take more time to process depending on your device performance."
          }
        },
        {
          "@type": "Question",
          "name": "Can I Compress Multiple PDF Files at Once?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, our tool supports batch compression. You can upload multiple PDF files at once and compress them all together. Multiple files will be downloaded as a ZIP archive."
          }
        }
      ]
    }
    </script>

    <!-- HowTo Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Compress PDF Online Free",
      "description": "Step by step guide to compress PDF files online for free using Rojgar Sangam Tools.",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Upload PDF File",
          "text": "Click the Upload PDF button or drag and drop your PDF file into the upload area."
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Select Compression Level",
          "text": "Choose your preferred compression level: Extreme, Recommended, or Less Compression based on your quality and size requirements."
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Compress PDF",
          "text": "Click the Compress PDF button and wait for the compression to complete in your browser."
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Download Compressed PDF",
          "text": "Click the Download PDF button to save your compressed PDF file to your device."
        }
      ]
    }
    </script>

    <style>
        body { font-family: 'Lora', serif !important; background: #f8f8ff; color: #333333; }
        #header-placeholder { background-color: #ffffff !important; width: 100%; display: block; position: relative; z-index: 1000; }
        .section-main { margin: 40px 0px 40px 0px !important; }
        .upload-section-wrapper { background: #ffffff; border-radius: 20px; padding: 40px 40px 40px 40px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .upload-area { border: 3px dashed #667799; border-radius: 16px; padding: 60px 20px 60px 20px; text-align: center; cursor: pointer; transition: all 0.3s ease; background: #f8f8ff; }
        .upload-area:hover { border-color: #00079e; background: #fdece5; }
        .upload-area.dragover { border-color: #00079e; background: #fdece5; }
        .upload-icon { font-size: 48px; color: #00079e; margin: 0px 0px 20px 0px; }
        .upload-text { font-size: 18px; font-weight: 700; color: #333333; margin: 0px 0px 10px 0px; }
        .upload-subtext { font-size: 14px; color: #667799; }
        .compress-workspace { display: none; }
        .compress-workspace.active { display: flex; gap: 30px; margin: 30px 0px 0px 0px; }
        .files-preview { flex: 1; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; max-height: 600px; overflow-y: auto; }
        .file-item { background: #ffffff; border: 2px solid #667799; border-radius: 12px; padding: 15px 15px 15px 15px; text-align: center; position: relative; }
        .file-item:hover { border-color: #00079e; background: #f8f8ff; }
        .file-preview { width: 100%; height: 220px; object-fit: contain; background: #f8f8ff; border-radius: 8px; margin: 0px 0px 10px 0px; }
        .file-name { font-size: 12px; color: #333333; word-break: break-word; font-weight: 600; }
        .remove-file-btn { position: absolute; top: -10px; right: -10px; width: 30px; height: 30px; background: #667799; color: #ffffff; border: none; border-radius: 50%; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(102,119,153,0.4); transition: all 0.3s ease; }
        .remove-file-btn:hover { background: #00079e; transform: scale(1.1); }
        .controls-panel { width: 450px; background: #ffffff; border: 1px solid #667799; border-radius: 12px; padding: 30px 30px 30px 30px; height: fit-content; position: sticky; top: 100px; }
        .controls-panel h2 { font-size: 28px; font-weight: 900; color: #333333; margin: 0px 0px 10px 0px; }
        .controls-panel .subtitle { font-size: 15px; color: #00079e; margin: 0px 0px 30px 0px; line-height: 1.5; background: #eff6ef; padding: 8px 12px 8px 12px; border-radius: 6px; display: inline-block; border: 1px solid #667799; }
        .compression-section { margin: 0px 0px 30px 0px; }
        .compression-section h3 { font-size: 16px; font-weight: 700; margin: 0px 0px 15px 0px; color: #333333; }
        .compression-option { background: #f8f8ff; border: 2px solid #667799; border-radius: 12px; padding: 18px 20px 18px 20px; margin: 0px 0px 12px 0px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 15px; }
        .compression-option:hover { border-color: #00079e; background: #fdece5; }
        .compression-option.selected { background: #eff6ef; border-color: #00079e; }
        .compression-option input[type="radio"] { width: 20px; height: 20px; cursor: pointer; accent-color: #00079e; }
        .compression-details { flex: 1; }
        .compression-title { font-size: 15px; font-weight: 700; margin: 0px 0px 4px 0px; color: #333333; }
        .compression-option.selected .compression-title { color: #00079e; }
        .compression-desc { font-size: 13px; color: #667799; margin: 0px 0px 0px 0px; }
        .compression-option.selected .compression-desc { color: #333333; }
        .check-icon { display: none; font-size: 20px; color: #00079e; }
        .compression-option.selected .check-icon { display: block; }
        .action-buttons { display: flex; gap: 15px; margin: 30px 0px 0px 0px; align-items: center; }
        .add-more-btn { width: 60px; height: 60px; background: #eff6ef; color: #00079e; border: 1px solid #667799; border-radius: 50%; font-size: 28px; cursor: pointer; transition: all 0.3s ease; }
        .add-more-btn:hover { background: #fdece5; transform: scale(1.05); }
        .compress-btn { flex: 1; padding: 18px 40px 18px 40px; background: #eff6ef; color: #00079e; border: 1px solid #667799; border-radius: 50px; font-size: 18px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; }
        .compress-btn:hover { background: #fdece5; transform: translateY(-2px); }
        .compress-btn:disabled { background: #bdbdbd; color: #ffffff; cursor: not-allowed; transform: none; border-color: #bdbdbd; }
        .processing-overlay, .success-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 9999; }
        .processing-overlay.active, .success-overlay.active { display: flex; }
        .processing-box, .success-box { background: #ffffff; border-radius: 20px; padding: 50px 50px 50px 50px; text-align: center; max-width: 550px; width: 90%; border: 1px solid #667799; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .processing-icon { font-size: 80px; color: #00079e; margin: 0px 0px 20px 0px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .processing-title { font-size: 32px; font-weight: 900; color: #333333; margin: 0px 0px 15px 0px; }
        .processing-title .highlight { background: #00079e; color: #ffffff; padding: 2px 8px 2px 8px; border-radius: 4px; }
        .processing-text { font-size: 14px; color: #00079e; line-height: 1.6; background: #eff6ef; padding: 10px 15px 10px 15px; border-radius: 8px; font-weight: 700; border: 1px solid #667799; }
        .success-icon { font-size: 80px; color: #00079e; margin: 0px 0px 20px 0px; }
        .success-title { font-size: 32px; font-weight: 900; color: #333333; margin: 0px 0px 20px 0px; line-height: 1.3; }
        .size-info { background: #eff6ef; border: 1px solid #667799; border-radius: 8px; padding: 12px 20px 12px 20px; margin: 0px 0px 20px 0px; font-size: 14px; color: #333333; font-weight: 600; }
        .warning-box { background: #fdece5; border-left: 4px solid #667799; padding: 15px 20px 15px 20px; border-radius: 8px; margin: 0px 0px 25px 0px; display: flex; align-items: flex-start; gap: 12px; }
        .warning-box i { color: #667799; font-size: 20px; margin: 2px 0px 0px 0px; }
        .warning-box p { margin: 0px 0px 0px 0px; font-size: 14px; color: #333333; font-style: italic; line-height: 1.5; }
        .download-btn { width: 100%; padding: 18px 40px 18px 40px; background: #eff6ef; color: #00079e; border: 1px solid #667799; border-radius: 50px; font-size: 18px; font-weight: 700; cursor: pointer; margin: 0px 0px 15px 0px; transition: all 0.3s ease; }
        .download-btn:hover { background: #fdece5; transform: translateY(-2px); }
        .back-btn { width: 100%; padding: 15px 40px 15px 40px; background: #ffffff; color: #333333; border: 1px solid #667799; border-radius: 50px; font-size: 16px; font-weight: 600; cursor: pointer; margin: 0px 0px 10px 0px; transition: all 0.3s ease; }
        .back-btn:hover { border-color: #00079e; color: #00079e; background: #fdece5; }
        .hidden { display: none; }
        #footer-placeholder { border: 1px solid #667799 !important; width: 100%; display: block; position: relative; }
        @media screen and (max-width: 1024px) {
            .compress-workspace.active { flex-direction: column; }
            .controls-panel { width: 100%; position: static; }
            .files-preview { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
        }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>
	<section class="section" style="margin:50px 0px 0px 0px!important">
	    <div class="row-container">
 	       <div class="ad-manager-placeholder ad-leaderboard" data-ad-type="leaderboard"></div>
 	       <div class="ad-manager-placeholder ad-rectangle" data-ad-type="rectangle"></div>
  	  </div>
	</section>
    <section class="section-main">
        <div class="row-container">
            <div style="text-align: center; margin: 0px 0px 30px 0px;">
                <h1 style="font-size: 36px; font-weight: 900; color: #333333; margin: 0px 0px 10px 0px;">Compress PDF Online Free: Reduce PDF File Size</h1>
                <p style="font-size: 16px; color: #333333; margin: 0px 0px 0px 0px;">Reduce File Size While Optimizing for Maximal PDF Quality.</p>
            </div>
            <div class="upload-section-wrapper">
                <div id="uploadArea" class="upload-area">
                    <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                    <div class="upload-text">+ Upload PDF</div>
                    <div class="upload-subtext">or Drop file here</div>
                    <input type="file" id="fileInput" accept=".pdf" multiple style="display: none;">
                </div>
                <div id="compressWorkspace" class="compress-workspace">
                    <div id="filesPreview" class="files-preview"></div>
                    <div class="controls-panel">
                        <h2>Compress PDF file</h2>
                        <div class="subtitle">Reduce file size while optimizing for maximal PDF quality.</div>
                        <div class="compression-section">
                            <h3>Compression level</h3>
                            <label class="compression-option" id="extremeOption">
                                <input type="radio" name="compression" value="extreme">
                                <div class="compression-details">
                                    <div class="compression-title">Extreme Compression</div>
                                    <div class="compression-desc">Less quality, high compression</div>
                                </div>
                                <i class="fas fa-check check-icon"></i>
                            </label>
                            <label class="compression-option selected" id="recommendedOption">
                                <input type="radio" name="compression" value="recommended" checked>
                                <div class="compression-details">
                                    <div class="compression-title">Recommended Compression</div>
                                    <div class="compression-desc">Good quality, good compression</div>
                                </div>
                                <i class="fas fa-check check-icon"></i>
                            </label>
                            <label class="compression-option" id="lessOption">
                                <input type="radio" name="compression" value="less">
                                <div class="compression-details">
                                    <div class="compression-title">Less Compression</div>
                                    <div class="compression-desc">High quality, less compression</div>
                                </div>
                                <i class="fas fa-check check-icon"></i>
                            </label>
                        </div>
                        <div class="action-buttons">
                            <button id="addMoreBtn" class="add-more-btn"><i class="fas fa-plus"></i></button>
                            <button id="compressBtn" class="compress-btn" disabled>Compress PDF →</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How To Use Section -->
    <section class="section-container" style="margin: 40px 0px 0px 0px !important; padding: 0px 0px 0px 0px !important;">
        <div class="row-container">
            <h2 style="font-weight: 900; margin: 0px 0px 25px 0px !important; text-align: center !important; color: #333333;">How to Compress PDF Online Free</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin: 0px 0px 40px 0px;">
                <div style="background: #ffffff; border: 1px solid #667799; border-radius: 12px; padding: 24px 20px 24px 20px; text-align: center;">
                    <div style="font-size: 36px; color: #00079e; margin: 0px 0px 12px 0px;"><i class="fas fa-upload"></i></div>
                    <div style="font-size: 16px; font-weight: 700; color: #333333; margin: 0px 0px 8px 0px;">Step 1: Upload PDF</div>
                    <div style="font-size: 13px; color: #667799;">Click Upload or drag and drop your PDF file into the upload area.</div>
                </div>
                <div style="background: #ffffff; border: 1px solid #667799; border-radius: 12px; padding: 24px 20px 24px 20px; text-align: center;">
                    <div style="font-size: 36px; color: #00079e; margin: 0px 0px 12px 0px;"><i class="fas fa-sliders-h"></i></div>
                    <div style="font-size: 16px; font-weight: 700; color: #333333; margin: 0px 0px 8px 0px;">Step 2: Choose Level</div>
                    <div style="font-size: 13px; color: #667799;">Select Extreme, Recommended, or Less compression as per your need.</div>
                </div>
                <div style="background: #ffffff; border: 1px solid #667799; border-radius: 12px; padding: 24px 20px 24px 20px; text-align: center;">
                    <div style="font-size: 36px; color: #00079e; margin: 0px 0px 12px 0px;"><i class="fas fa-compress-arrows-alt"></i></div>
                    <div style="font-size: 16px; font-weight: 700; color: #333333; margin: 0px 0px 8px 0px;">Step 3: Compress</div>
                    <div style="font-size: 13px; color: #667799;">Click Compress PDF button and wait for processing to complete.</div>
                </div>
                <div style="background: #ffffff; border: 1px solid #667799; border-radius: 12px; padding: 24px 20px 24px 20px; text-align: center;">
                    <div style="font-size: 36px; color: #00079e; margin: 0px 0px 12px 0px;"><i class="fas fa-download"></i></div>
                    <div style="font-size: 16px; font-weight: 700; color: #333333; margin: 0px 0px 8px 0px;">Step 4: Download</div>
                    <div style="font-size: 13px; color: #667799;">Download your compressed PDF file directly to your device.</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Info Section -->
    <section class="section-container" style="margin: 40px 0px 0px 0px !important; padding: 0px 0px 0px 0px !important;">
        <div class="row-container">
            <h2 style="font-weight: 900; margin: 0px 0px 25px 0px !important; text-align: center !important; color: #333333;">Efficient PDF Compression Technology</h2>
            <p style="font-size: 16px; color: #333333; line-height: 1.8; margin: 0px 0px 30px 0px !important; text-align: center !important;">Our Advanced Compression Algorithm Reduces PDF File Size Without Compromising Quality. All Processing Happens in Your Browser for Maximum Security.</p>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="section-container" style="margin: 40px 0px 40px 0px !important; padding: 0px 0px 0px 0px !important;">
        <div class="row-container">
            <h2 style="font-weight: 900; margin: 0px 0px 25px 0px !important; text-align: center !important; color: #333333;">Frequently Asked Questions</h2>
            <div class="faq-list">
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span>How Much can I Compress a PDF File?</span>
                        <i class="faq-icon">+</i>
                    </div>
                    <div class="faq-answer">
                        <p>Compression Depends on the Original File Content. Typically, You can Reduce File Size by 40-60% While Maintaining Good Visual Quality.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span>Which Compression Level Should I Choose?</span>
                        <i class="faq-icon">+</i>
                    </div>
                    <div class="faq-answer">
                        <p>We Recommend the "Recommended Compression" Option for the Best Balance Between File Size and Quality. Use "Extreme" for Maximum Reduction when file size is the priority.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span>Is My PDF Safe During Compression?</span>
                        <i class="faq-icon">+</i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes, All Compression is Done Locally in Your Browser. Your Files Never Leave Your Device and are Not Stored on Any Server. It is 100% Private and Secure.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span>What is the Maximum File Size I can Compress?</span>
                        <i class="faq-icon">+</i>
                    </div>
                    <div class="faq-answer">
                        <p>You can Compress PDF Files of any Size. However, Very Large Files may Take More Time to Process Depending on Your Device Performance and Available Memory.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span>Can I Compress Multiple PDF Files at Once?</span>
                        <i class="faq-icon">+</i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes, Our Tool Supports Batch Compression. You can Upload Multiple PDF Files at Once and Compress them all Together. Multiple Files will be Downloaded as a ZIP Archive.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="section-main">
    	<div class="row-custom">
        <div class="ad-manager-placeholder" data-ad-type="responsive"></div>
    	</div>
	</section>
    <!-- Processing Overlay -->
    <div id="processingOverlay" class="processing-overlay">
        <div class="processing-box">
            <div class="processing-icon"><i class="fas fa-file-alt"></i></div>
            <div class="processing-title"><span class="highlight">Compressing</span> PDF</div>
            <div class="processing-text">Do not close your browser. Wait until your files are processed!<br>This might take a few minutes.</div>
        </div>
    </div>

    <!-- Success Overlay -->
    <div id="successOverlay" class="success-overlay">
        <div class="success-box">
            <div class="success-icon"><i class="fas fa-check-circle"></i></div>
            <div class="success-title">PDFs have been compressed</div>
            <div id="sizeInfo" class="size-info"></div>
            <div id="warningBox" class="warning-box hidden">
                <i class="fas fa-exclamation-triangle"></i>
                <p>This file is already optimized. No further compression possible without quality loss.</p>
            </div>
            <button id="downloadBtn" class="download-btn">Download PDF <i class="fas fa-download"></i></button>
            <button id="backToCompressBtn" class="back-btn">Back to Compress PDF</button>
            <div style="margin: 15px 0px 15px 0px; color: #667799; font-size: 14px;">OR</div>
            <button id="backToHomeBtn" class="back-btn">Back to Home</button>
        </div>
    </div>

    <div id="footer-placeholder"></div>
	<script src="/js/ad-manager.js"></script>
	<script src="/js/main.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        let pdfFiles        = [];
        let compressedFiles = [];
        let compressionLevel = 'recommended';

        const uploadArea         = document.getElementById('uploadArea');
        const fileInput          = document.getElementById('fileInput');
        const compressWorkspace  = document.getElementById('compressWorkspace');
        const filesPreview       = document.getElementById('filesPreview');
        const addMoreBtn         = document.getElementById('addMoreBtn');
        const compressBtn        = document.getElementById('compressBtn');
        const processingOverlay  = document.getElementById('processingOverlay');
        const successOverlay     = document.getElementById('successOverlay');
        const downloadBtn        = document.getElementById('downloadBtn');
        const backToCompressBtn  = document.getElementById('backToCompressBtn');
        const backToHomeBtn      = document.getElementById('backToHomeBtn');
        const warningBox         = document.getElementById('warningBox');
        const sizeInfo           = document.getElementById('sizeInfo');

        // ── Compression Level Selection ──
        document.querySelectorAll('.compression-option').forEach(option => {
            option.addEventListener('click', function () {
                document.querySelectorAll('.compression-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                this.querySelector('input[type="radio"]').checked = true;
                compressionLevel = this.querySelector('input[type="radio"]').value;
            });
        });

        // ── Upload Events ──
        uploadArea.addEventListener('click', () => fileInput.click());
        addMoreBtn.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', e => { handleFiles(Array.from(e.target.files)); fileInput.value = ''; });
        uploadArea.addEventListener('dragover', e => { e.preventDefault(); uploadArea.classList.add('dragover'); });
        uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('dragover'));
        uploadArea.addEventListener('drop', e => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files).filter(f => f.type === 'application/pdf');
            if (files.length > 0) handleFiles(files);
        });

        compressBtn.addEventListener('click', processCompression);
        downloadBtn.addEventListener('click', downloadFiles);
        backToCompressBtn.addEventListener('click', reset);
        backToHomeBtn.addEventListener('click', () => window.location.href = '../index.html');

        // ── Handle File Upload ──
        async function handleFiles(files) {
            for (const file of files) {
                const reader = new FileReader();
                reader.onload = async function (e) {
                    const arrayBuffer = e.target.result;
                    const loadingTask = pdfjsLib.getDocument({data: arrayBuffer.slice(0)});
                    const pdf         = await loadingTask.promise;
                    const page        = await pdf.getPage(1);
                    const viewport    = page.getViewport({scale: 0.5});
                    const canvas      = document.createElement('canvas');
                    canvas.height     = viewport.height;
                    canvas.width      = viewport.width;
                    const ctx         = canvas.getContext('2d');
                    ctx.fillStyle     = '#ffffff';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    await page.render({canvasContext: ctx, viewport}).promise;
                    pdfFiles.push({file, arrayBuffer, preview: canvas.toDataURL(), name: file.name, originalSize: file.size});
                    renderFiles();
                };
                reader.readAsArrayBuffer(file);
            }
        }

        // ── Render File Previews ──
        function renderFiles() {
            if (!pdfFiles.length) {
                filesPreview.innerHTML = '';
                compressWorkspace.classList.remove('active');
                uploadArea.style.display = 'block';
                compressBtn.disabled = true;
                return;
            }
            uploadArea.style.display = 'none';
            compressWorkspace.classList.add('active');
            compressBtn.disabled = false;
            filesPreview.innerHTML = '';
            pdfFiles.forEach((pdf, i) => {
                const el = document.createElement('div');
                el.className = 'file-item';
                el.innerHTML = `<button class="remove-file-btn" onclick="removeFile(${i})"><i class="fas fa-times"></i></button><img src="${pdf.preview}" class="file-preview" alt="PDF Preview"><div class="file-name">${pdf.name}</div>`;
                filesPreview.appendChild(el);
            });
        }

        function removeFile(i) { pdfFiles.splice(i, 1); renderFiles(); }
        window.removeFile = removeFile;

        function formatSize(bytes) {
            if (bytes >= 1048576) return (bytes / 1048576).toFixed(2) + ' MB';
            return (bytes / 1024).toFixed(1) + ' KB';
        }

        // ── Core Compression Logic (Exactly like SarkariResultPortal) ──
        async function compressOnePdf(pdfFile) {
            // Tuned settings — same quality/scale ratio as top tools
            const settings = {
                extreme:     { scale: 1.2, quality: 0.55 },
                recommended: { scale: 1.5, quality: 0.75 },
                less:        { scale: 2.0, quality: 0.90 }
            };
            const { scale, quality } = settings[compressionLevel];

            const loadingTask = pdfjsLib.getDocument({data: pdfFile.arrayBuffer.slice(0)});
            const pdfJsDoc    = await loadingTask.promise;
            const totalPages  = pdfJsDoc.numPages;
            const newPdf      = await PDFLib.PDFDocument.create();

            for (let p = 1; p <= totalPages; p++) {
                const page           = await pdfJsDoc.getPage(p);
                const origViewport   = page.getViewport({scale: 1.0});
                const renderViewport = page.getViewport({scale});

                const canvas = document.createElement('canvas');
                canvas.width  = renderViewport.width;
                canvas.height = renderViewport.height;
                const ctx = canvas.getContext('2d');
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                await page.render({canvasContext: ctx, viewport: renderViewport}).promise;

                const jpegUrl   = canvas.toDataURL('image/jpeg', quality);
                const jpegBytes = Uint8Array.from(atob(jpegUrl.split(',')[1]), c => c.charCodeAt(0));
                const jpgImage  = await newPdf.embedJpg(jpegBytes);
                const pdfPage   = newPdf.addPage([origViewport.width, origViewport.height]);
                pdfPage.drawImage(jpgImage, {x: 0, y: 0, width: origViewport.width, height: origViewport.height});
            }

            const compressedBytes = await newPdf.save();

            // Smart guard — never return bigger file than original
            if (compressedBytes.length >= pdfFile.originalSize) {
                return {bytes: new Uint8Array(pdfFile.arrayBuffer), size: pdfFile.originalSize, reduction: 0};
            }
            const reduction = ((pdfFile.originalSize - compressedBytes.length) / pdfFile.originalSize * 100).toFixed(1);
            return {bytes: compressedBytes, size: compressedBytes.length, reduction};
        }

        // ── Process All Files ──
        async function processCompression() {
            processingOverlay.classList.add('active');
            compressedFiles = [];
            try {
                for (const pdfFile of pdfFiles) {
                    const result = await compressOnePdf(pdfFile);
                    console.log(`${pdfFile.name}: ${formatSize(pdfFile.originalSize)} → ${formatSize(result.size)} (${result.reduction}% reduced)`);
                    compressedFiles.push({
                        name: pdfFile.name.replace('.pdf', '-compressed.pdf'),
                        data: result.bytes,
                        originalSize: pdfFile.originalSize,
                        compressedSize: result.size,
                        reduction: result.reduction
                    });
                }
                setTimeout(() => {
                    processingOverlay.classList.remove('active');
                    const totalOrig = compressedFiles.reduce((s, f) => s + f.originalSize, 0);
                    const totalComp = compressedFiles.reduce((s, f) => s + f.compressedSize, 0);
                    const avgReduction = ((totalOrig - totalComp) / totalOrig * 100).toFixed(1);
                    sizeInfo.innerHTML = `<i class="fas fa-chart-bar" style="color:#00079e; margin-right:8px;"></i>${formatSize(totalOrig)} → <strong>${formatSize(totalComp)}</strong> &nbsp;|&nbsp; <strong style="color:#00079e;">${avgReduction}% reduced</strong>`;
                    warningBox.classList.toggle('hidden', parseFloat(avgReduction) >= 5);
                    successOverlay.classList.add('active');
                }, 1000);
            } catch (err) {
                console.error(err);
                alert('Error compressing PDF. Please try again.');
                processingOverlay.classList.remove('active');
            }
        }

        // ── Download Files ──
        async function downloadFiles() {
            if (compressedFiles.length === 1) {
                const blob = new Blob([compressedFiles[0].data], {type: 'application/pdf'});
                const a = Object.assign(document.createElement('a'), {href: URL.createObjectURL(blob), download: compressedFiles[0].name});
                document.body.appendChild(a); a.click(); document.body.removeChild(a);
            } else {
                const zip = new JSZip();
                compressedFiles.forEach(f => zip.file(f.name, f.data));
                const blob = await zip.generateAsync({type: 'blob'});
                const a = Object.assign(document.createElement('a'), {href: URL.createObjectURL(blob), download: 'compressed-pdfs.zip'});
                document.body.appendChild(a); a.click(); document.body.removeChild(a);
            }
        }

        // ── Reset Tool ──
        function reset() {
            successOverlay.classList.remove('active');
            uploadArea.style.display = 'block';
            compressWorkspace.classList.remove('active');
            pdfFiles = []; compressedFiles = [];
            filesPreview.innerHTML = ''; fileInput.value = '';
            compressionLevel = 'recommended';
            document.querySelectorAll('.compression-option').forEach(o => o.classList.remove('selected'));
            document.getElementById('recommendedOption').classList.add('selected');
            document.querySelector('input[value="recommended"]').checked = true;
        }
    </script>
</body>
</html>
