<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word to PDF Converter Online Free: All Office Formats Supported</title>
    <meta name="description" content="Use Rojgar Sangam Tools to convert MS Office DOCX, LibreOffice ODT, and other Word files to PDF online free and securely. No data upload, 100% private.">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>

    <header class="header-main">
        <div class="row-settings flex justify-between items-center">
            <a href="../index.html">
                <img src="https://raw.githubusercontent.com/sanjeevkumarambn/tools/main/Rojgar%20Sangam%20HD%20Logo.png" class="logo-img" alt="Rojgar Sangam">
            </a>
            <nav class="nav-menu">
                <a href="../index.html" class="nav-link">Home</a>
                <a href="../index.html" class="nav-link">Tools</a>
                <a href="https://rojgarsangam.in/contact-us/" class="nav-link">Contact</a>
            </nav>
        </div>
    </header>

    <main>
        <section id="screen-1" class="section-custom">
            <div class="row-settings text-center">
                <h1 class="h1-main">Word to PDF Converter Online: Support for All Office Tools</h1>
                <p class="text-gray-500 mb-8">Convert MS Word (.docx), LibreOffice (.odt), and other formats to PDF instantly.</p>
                
                <div class="bg-white p-12 rounded-3xl border-2 border-dashed border-[#00079e] max-w-xl mx-auto cursor-pointer hover:bg-[#f8f8ff] transition" onclick="document.getElementById('docInput').click()">
                    <div class="text-5xl text-blue-500 mb-4"><i class="fas fa-file-word"></i></div>
                    <p class="font-bold text-[#333333]">Choose Office File</p>
                    <p class="text-xs text-gray-400 mt-1">Supports MS Office, LibreOffice & more</p>
                    <input type="file" id="docInput" class="hidden" accept=".docx,.odt,.doc,.rtf" onchange="handleFile(event)">
                </div>

                <div class="mt-16 bg-[#eff6ef] p-10 rounded-3xl text-left max-w-4xl mx-auto border border-[#bdbdbd]">
                    <h2 class="text-xl font-bold text-[#333333] mb-4 border-l-4 border-[#00079e] pl-4">Universal Word to PDF Converter Online</h2>
                    <p class="p-hero text-sm">
                        Whether you use MS Office or open-source tools like LibreOffice, our rojgar sangam tools are designed to help you. This word to pdf converter online supports multiple formats for your convenience.
                    </p>
                    <p class="p-hero text-sm">
                        Converting your documents to PDF ensures that the formatting remains the same on every device. This is crucial for resumes and certificates being sent to government job portals today.
                    </p>
                    <p class="p-hero text-sm">
                        We prioritize your privacy above all else. Just like our compress pdf online free tool, all processing happens locally. No matter which office tool you use, your files are never uploaded to any server.
                    </p>
                </div>
            </div>
        </section>

        <section id="screen-2" class="section-custom hidden">
            <div class="row-settings flex flex-col md:flex-row gap-8">
                <div class="w-full md:w-2/3 bg-white p-8 rounded-xl border border-[#bdbdbd] text-center">
                    <div class="text-6xl text-blue-600 mb-4"><i class="fas fa-file-alt"></i></div>
                    <h3 id="fileName" class="font-bold text-gray-700 mb-2 truncate">document</h3>
                    <p id="fileType" class="text-xs text-green-600 font-bold uppercase tracking-widest"></p>
                </div>
                
                <div class="w-full md:w-1/3 bg-white p-8 rounded-xl border border-[#bdbdbd]">
                    <h3 class="font-bold text-lg mb-4">Finalizing Conversion</h3>
                    <p class="text-sm text-gray-600 mb-6">Your file is ready to be transformed into a secure, professional PDF document.</p>
                    <button class="btn-brand w-full py-4 flex items-center justify-center gap-2" onclick="processConversion()">
                        Convert Now <i class="fas fa-magic"></i>
                    </button>
                    <button class="w-full text-xs text-gray-400 mt-4 underline" onclick="location.reload()">Select Different File</button>
                </div>
            </div>
        </section>

        <section id="screen-3" class="section-custom hidden">
            <div class="row-settings text-center py-20 bg-white rounded-3xl border border-[#bdbdbd] max-w-2xl">
                <div class="mb-6"><img src="https://cdn-icons-png.flaticon.com/512/10515/10515124.png" class="w-20 mx-auto animate-bounce"></div>
                <h2 class="text-2xl font-bold text-[#333333]">Processing Your Document</h2>
                <p class="text-gray-500 mt-2 text-sm">Optimizing layout for PDF, please wait...</p>
            </div>
        </section>

        <section id="screen-4" class="section-custom hidden">
            <div class="row-settings text-center py-12 bg-white rounded-3xl border border-[#bdbdbd] max-w-2xl">
                <div class="text-6xl text-green-500 mb-6"><i class="fas fa-check-circle"></i></div>
                <h2 class="text-3xl font-extrabold text-[#333333] mb-8">Success!</h2>
                
                <div class="flex flex-col gap-4 max-w-xs mx-auto">
                    <button class="btn-brand flex items-center justify-center gap-2" onclick="downloadResult()">
                        Download PDF <i class="fas fa-download"></i>
                    </button>
                    <button class="btn-outline" onclick="location.reload()">Convert More</button>
                </div>
            </div>
        </section>

        <div id="hidden-render" style="position:absolute; left:-9999px; width:800px; background: white; padding: 40px;"></div>
        <div class="ad-manager-placeholder row-settings" data-ad-type="leaderboard"></div>
    </main>

    <footer class="footer-main">
        <div class="row-settings text-center text-[10px] text-gray-400">
            Rojgar Sangam Tools - All-in-One Office Converter
        </div>
    </footer>

    <script src="../js/ad-manager.js"></script>
    <script src="../js/main.js"></script>
    <script>
        let docFile = null;
        let pdfBlob = null;

        function handleFile(e) {
            docFile = e.target.files[0];
            if (!docFile) return;

            document.getElementById('fileName').innerText = docFile.name;
            document.getElementById('fileType').innerText = docFile.name.split('.').pop().toUpperCase();
            switchScreen(2);
        }

        async function processConversion() {
            switchScreen(3);
            const ext = docFile.name.split('.').pop().toLowerCase();

            try {
                const arrayBuffer = await docFile.arrayBuffer();
                let htmlContent = "";

                if (ext === 'docx') {
                    const result = await mammoth.convertToHtml({ arrayBuffer: arrayBuffer });
                    htmlContent = result.value;
                } else {
                    // LibreOffice (ODT) ya purane formats ke liye user ko warn karna 
                    // ki unhe modern browser compatibility ke liye save as docx karna chahiye
                    // Par hum koshish karenge generic text extraction ki
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const text = e.target.result;
                        document.getElementById('hidden-render').innerText = text;
                    };
                    reader.readAsText(docFile);
                }

                const renderArea = document.getElementById('hidden-render');
                if(htmlContent) renderArea.innerHTML = htmlContent;

                const opt = {
                    margin: 0.5,
                    filename: 'converted-rojgar-sangam.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                };

                const pdfWorker = html2pdf().from(renderArea).set(opt);
                pdfBlob = await pdfWorker.output('blob');

                setTimeout(() => switchScreen(4), 2000);
            } catch (err) {
                alert("This specific format version is not supported yet for direct browser conversion. Please save it as .docx first for 100% privacy.");
                switchScreen(1);
            }
        }

        function downloadResult() {
            if (!pdfBlob) return;
            const link = document.createElement('a');
            link.href = URL.createObjectURL(pdfBlob);
            link.download = docFile.name.replace(/\.[^/.]+$/, "") + ".pdf";
            link.click();
        }

        function switchScreen(id) {
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            document.getElementById('screen-' + id).classList.remove('hidden');
        }
    </script>
</body>
</html>
